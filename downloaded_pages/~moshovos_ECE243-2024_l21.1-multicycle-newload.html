<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1253">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="l21.1-multicycle-newload_files/filelist.xml">
<link rel=Edit-Time-Data href="l21.1-multicycle-newload_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Computer Organization</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-alt:Batang;
	mso-font-charset:129;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:"\@Batang";
	mso-font-charset:129;
	mso-generic-font-family:auto;
	mso-font-pitch:auto;
	mso-font-signature:0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:Batang;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:Batang;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 65.95pt 1.0in 65.95pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:178155032;
	mso-list-type:hybrid;
	mso-list-template-ids:-1242780162 1016510748 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:185607659;
	mso-list-type:hybrid;
	mso-list-template-ids:2135691118 1090137930 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-text:"\(%1\)";
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-24.0pt;}
@list l1:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:742068944;
	mso-list-type:hybrid;
	mso-list-template-ids:988686646 67698709 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-number-format:alpha-upper;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l2:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3
	{mso-list-id:997614472;
	mso-list-type:hybrid;
	mso-list-template-ids:1612638044 398887690 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="9218"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoPlainText>Computer Organization</p>

<p class=MsoPlainText>Introducing New Instructions</p>

<p class=MsoPlainText>Andreas <span class=SpellE>Moshovos</span></p>

<p class=MsoPlainText>Spring 2006</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>Extending/Changing
the <span class=SpellE>Datapath</span><o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoPlainText>We have seen how to design a complete <span class=SpellE>datapath</span>
and control. Now let’s see how we can change this <span class=SpellE>datapath</span>
to support new or different instructions. Because our instruction encoding is
dense and does not allow for the introduction of new instructions, let’s see
how we can implement a different LOAD instruction. So, what if we wanted to
*replace* load with the following:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>LOAD r1 (r2<span class=GramE>)+</span></p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>We first start with the behavioral model of this
instruction. This is the programmer’s model, or in other words the way the
programmer expects this instruction to behave. As a designer, this model is our
contract. We have to design a processor that adheres to this model. This way
the programmer can reason about program behavior.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>So <b style='mso-bidi-font-weight:normal'>the behavioral
model</b> of the new LOAD is:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>R1 = MEM [R2]</p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>R2 = [R2] + 1</p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>PC = [PC] + 1</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>In words, we read R2, use this value as an address to
read from memory, the value we read from memory we write into r1. Then we
increment r2 by 1. Finally, we increment PC by 1.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>Starting from this model let’s see what are the actions
that need to take place in the <span class=SpellE>datapath</span>.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='text-indent:.25in'><b style='mso-bidi-font-weight:
normal'>Going from the behavioral model to a set of actions that need to take
place in the <span class=SpellE>datapath</span>:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>A.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>First we have to read the instruction into the
IR</p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>B.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>For part (1) we need to do the following:</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Read
R2</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Read
from memory using the value read in step (a) as the address</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Write
the value read from memory in (b) into R1</p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>C.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>For part (2) we need to do the following:</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Read
R2</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Add
1 to the value read in step (a)</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Write
the value produced in step (c) into register R2</p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>D.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>For part (3):</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Read
the PC</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Add
1 to the value read in step (a)</p>

<p class=MsoPlainText style='margin-left:1.0in;text-indent:-.25in;mso-list:
l2 level2 lfo4;tab-stops:list 1.0in'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>Write
the value produced in step (c) into the PC.</p>

<p class=MsoPlainText><br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></p>

<p class=MsoPlainText>Now let’s attempt to assign these actions into cycles.
Any *valid* assignment into cycles is acceptable. An assignment to cycles is
valid if: (<span class=SpellE>i</span>) it maintains the order of actions
(i.e., action <span class=SpellE>B.a</span> happens before action <span
class=SpellE>B.b</span>), (ii) and as long as the <span class=SpellE>datapath</span>
can support the necessary actions.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>Let’s focus on part (<span class=SpellE>i</span>) first,
that is let’s <span class=GramE>assign</span> the actions into cycles. The
first two cycles are the same for all instruction because in cycle 1 we read
the instruction from memory and in cycle 2 the control looks at it and tries to
decide what to do next. </p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 1:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span>IR &lt;-- <span class=GramE>MEM[</span>PC]<span
style='mso-spacerun:yes'>  </span>* ACTION A: Read instruction from memory
store it in IR<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span>PC &lt;-- PC + 1<span
style='mso-spacerun:yes'>     </span>* ACTIONS <span class=SpellE>D.a</span>
through <span class=SpellE>D.c</span>: Increment PC<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 2:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span>R1 &lt;-- <span class=GramE>RF[</span>IR7,6]<span
style='mso-spacerun:yes'>    </span>* NOT NEEDED BY LOAD: Read register R1 (as
specified by bits 7 and 6 or the IR)<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span>R2 &lt;-- <span class=GramE>RF[</span>IR5,4]<span
style='mso-spacerun:yes'>    </span>* ACTION <span class=SpellE>C.a</span>:
Read register R2<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoPlainText>Note that here we did not yet have time to look at the
instruction. So, we are performing two reads that *may* be useful. For loads
these are useful but we take these actions for all instructions.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 3:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span>MDR &lt;-- <span class=GramE>MEM[</span>R2]
* ACTION <span class=SpellE>B.b</span>: read value from memory<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 4: <o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span><span class=GramE>RF[</span>IR7,6] &lt;--
[MDR] * ACTION <span class=SpellE>B.c</span>: write value read from memory
intro the register file<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 5:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span><span class=SpellE>AluOut</span> &lt;-- R2
+ 1<span style='mso-spacerun:yes'>   </span>* ACTION <span class=SpellE>C.b</span>:
add 1 to the value read in action <span class=SpellE>C.a</span><o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 6:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span><span class=GramE>RF[</span>IR5,4] &lt;-- <span
class=SpellE>AluOut</span> * ACTION <span class=SpellE>C.c</span>: write the
value produced in action <span class=SpellE>C.b</span> into R2<o:p></o:p></b></p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>This is not the shortest in terms of <span class=GramE>cycles</span>
assignment. We can notice that in CYCLE 3 we can also do <span class=SpellE>C.b</span>:</p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 3:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span>MDR &lt;-- <span class=GramE>MEM[</span>R2]
* ACTION <span class=SpellE>B.b</span>: read value from memory<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span><span class=SpellE>AluOut</span> &lt;-- R2
+ 1<span style='mso-spacerun:yes'>   </span>* ACTION <span class=SpellE>C.b</span>:
add 1 to the value read in action <span class=SpellE>C.a</span><o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 4: <o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span><span class=GramE>RF[</span>IR7,6] &lt;--
[MDR] * ACTION <span class=SpellE>B.c</span>: write value read from memory
intro the register file<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>CYCLE 5:<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span
style='mso-tab-count:1'>      </span><span class=GramE>RF[</span>IR5,4] &lt;-- <span
class=SpellE>AluOut</span> * ACTION <span class=SpellE>C.c</span>: write the
value produced in action <span class=SpellE>C.b</span> into R2<o:p></o:p></b></p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>We cannot do <span class=SpellE>B.c</span> and <span
class=SpellE>C.c</span> during the same cycle since they both use the register
file’s write port (and there is only one of it).</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>Is the <span class=SpellE>datapath</span> capable of
performing all these actions? Yes, except for Action C.c. For this we need to
be able to use bits 5<span class=GramE>,4</span> or the IR to specify the
target register. Our current <span class=SpellE>datapath</span> has <span
class=SpellE>regw</span> connected to IR7<span class=GramE>,6</span> or to 1:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>ORIGINAL DATAPATH<o:p></o:p></b></p>

<p class=MsoPlainText><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:652.5pt;
 height:354pt'>
 <v:imagedata src="l21.1-multicycle-newload_files/image001.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=870 height=472
src="l21.1-multicycle-newload_files/image002.gif" v:shapes="_x0000_i1025"><![endif]></p>

<p class=MsoPlainText>So, we need to introduce:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='margin-left:42.0pt;text-indent:-24.0pt;mso-list:
l1 level1 lfo6;tab-stops:list 42.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>(1)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>The
capability of using either IR7<span class=GramE>,6</span> or IR5,4 for <span
class=SpellE>regw</span>. Here’s the modified <span class=SpellE>datapath</span>:</p>

<p class=MsoPlainText style='margin-left:42.0pt;text-indent:-24.0pt;mso-list:
l1 level1 lfo6;tab-stops:list 42.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Courier New"'><span style='mso-list:Ignore'>(2)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]>The
capability of passing R2 and 1 as the two arguments to the ALU for addition.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><!--[if gte vml 1]><v:shape id="_x0000_i1026" type="#_x0000_t75"
 style='width:652.5pt;height:354pt'>
 <v:imagedata src="l21.1-multicycle-newload_files/image003.jpg" o:title="image004"/>
</v:shape><![endif]--><![if !vml]><img width=870 height=472
src="l21.1-multicycle-newload_files/image003.jpg" v:shapes="_x0000_i1026"><![endif]></p>

<p class=MsoPlainText>The new control signal <span class=SpellE><b
style='mso-bidi-font-weight:normal'>rwsel</b></span><b style='mso-bidi-font-weight:
normal'> </b>allows us to either use IR7<span class=GramE>,6</span> or IR5,4
for <span class=SpellE>regw</span>. The ALU1 signal now becomes a two bit
signal as we introduced the option of passing the value of R2 as the first
input to the ALU.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'>Behavioral
Semantics<o:p></o:p></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoPlainText>Let us now closely inspect whether the implementation
really adheres to the instruction definition. Our definition says that the new
LOAD R1 (R2<span class=GramE>)+</span> instruction does:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='margin-left:.25in'>1. R1 = MEM [R2]</p>

<p class=MsoPlainText style='margin-left:.25in'>2. R2 = R2 + 1</p>

<p class=MsoPlainText style='margin-left:.25in'>3. PC = PC + 1</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>Notice that the way this is written one can reasonably
assume that first we do (1) and then we do (2).</p>

<p class=MsoPlainText>What would happen if the instruction was LOAD K1 (K1<span
class=GramE>)+</span>? Our definition then says:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='margin-left:.25in'>1. K1 = MEM [K1]</p>

<p class=MsoPlainText style='margin-left:.25in'>2. K1 = K1 + 1</p>

<p class=MsoPlainText style='margin-left:.25in'>3. PC = PC + 1</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>At the end, K1 should be the value we read from memory
incremented by 1. However, our implementation does do that. What it does is,
first load a value from memory using K1 as the address. Then it increments the
value K1 had before the memory read by 1 and writes that value into K1.</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText>At this point there are the following two solutions:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Rethink the instruction definition. We can
rewrite the instruction definition to reflect what we learned while trying to
implement it. The definition can become:</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:.25in'>a. TMP = R2<span
style='mso-tab-count:1'> </span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:.25in'>b. R1 = MEM
[R2]</p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:.25in'>c. R2 = TMP +
1</p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:.25in'>d. PC = PC +
1</p>

<p class=MsoPlainText><o:p>&nbsp;</o:p></p>

<p class=MsoPlainText><span style='mso-tab-count:1'>      </span>As we will see
in option 2, implementing the first definition requires 6 cycles. Learning from
the implementation we can decide that probably our initially choice for the
instruction was not really well thought out. Processor designers go through
such refinement steps all the time prior to shipping the final design.
Sometimes, however, even the best design teams do not necessarily interpret or
predict all details. Sometimes, they end up building processors that behave
slightly differently than what they planned. In many processor manuals there is
often an “Errata” section where the designers explain how the implementation is
different than the specification. In other words, most processor manuals can be
thought of a two separate sections. The first section is “this is what we
planned to build”, and the second “these are the differences in what we build”.</p>

</div>

</body>

</html>
